<!DOCTYPE html>
<html>
  <head>
    <title>GPS Route Viewer</title>
    <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyARV4diMv1oEUD3AkgZj5UBoMFN2G0kuVc&callback=initMap&libraries=maps,marker&v=beta"></script>
    <style>
      html, body, gmp-map { height: 100%; margin: 0; padding: 0; }
    </style>
    <script>
      async function initMap() {

        console.log("initMap gestart...");
        try {
            const response = await fetch("http://192.168.1.23/gps");
            console.log("Fetch status:", response.status);

            const text = await response.text();
            console.log("Ontvangen tekst:", text);

            const points = JSON.parse(text);
            console.log("Aantal punten:", points.length);
        

            const map = new google.maps.Map(document.getElementById("map"), {
            center: { lat: points[0].lat, lng: points[0].lon },
            zoom: 15,
            });

            // Markers tekenen
            points.forEach((p) => {
            new google.maps.Marker({ position: { lat: p.lat, lng: p.lon }, map });
            });

            // Route tekenen
            const path = points.map(p => ({ lat: p.lat, lng: p.lon }));
            new google.maps.Polyline({
            path: path,
            map: map,
            strokeColor: "red",
            strokeWeight: 4,
            });
        } catch (error) {
            console.error("‚ùå Fout tijdens ophalen of verwerken van GPS-data:", error);
        }    
      }
    </script>
  </head>
  <body>
    <div id="map"></div>
  </body>
</html>
